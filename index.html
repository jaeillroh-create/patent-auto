<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>특허명세서 자동 생성 — DIDIM IP</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" />
  <link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/gh/toss/tossface/dist/tossface.css" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>

<!-- ═══════════════ Toast Container ═══════════════ -->
<div id="toastContainer" class="toast-container"></div>

<!-- ═══════════════ Auth Screen: Login / Signup ═══════════════ -->
<div id="screenAuth" class="screen active">
  <div class="auth-wrapper">
    <div class="auth-logo">
      <img src="logo.png" alt="DIDIM IP" class="logo-img" />
    </div>
    <div class="auth-card card">
      <div class="auth-tabs">
        <button class="auth-tab active" onclick="switchAuthTab('login')">로그인</button>
        <button class="auth-tab" onclick="switchAuthTab('signup')">회원가입</button>
      </div>

      <!-- Login Form -->
      <div id="authLogin" class="auth-form">
        <input type="email" class="input-field" id="loginEmail" placeholder="이메일" />
        <input type="password" class="input-field" id="loginPassword" placeholder="비밀번호" style="margin-top:8px" />
        <button class="btn btn-primary btn-full" id="btnLogin" onclick="handleLogin()" style="margin-top:16px">
          로그인
        </button>
      </div>

      <!-- Signup Form -->
      <div id="authSignup" class="auth-form" style="display:none">
        <input type="email" class="input-field" id="signupEmail" placeholder="이메일" />
        <input type="password" class="input-field" id="signupPassword" placeholder="비밀번호 (6자 이상)" style="margin-top:8px" />
        <input type="text" class="input-field" id="signupName" placeholder="이름 (선택)" style="margin-top:8px" />
        <button class="btn btn-primary btn-full" id="btnSignup" onclick="handleSignup()" style="margin-top:16px">
          회원가입
        </button>
      </div>
    </div>
    <p class="auth-footer">특허그룹 디딤 · 시너지앤(주)</p>
  </div>
</div>

<!-- ═══════════════ ToS Screen ═══════════════ -->
<div id="screenTos" class="screen">
  <div class="auth-wrapper">
    <div class="auth-logo">
      <img src="logo.png" alt="DIDIM IP" class="logo-img" />
    </div>
    <div class="card" style="max-width:480px;margin:0 auto">
      <div class="card-header">
        <div class="card-title"><span class="tossface">📜</span> 이용 동의</div>
      </div>
      <p class="card-description" style="margin-bottom:16px">
        서비스 이용을 위해 아래 항목에 동의해 주세요.
      </p>
      <label class="checkbox-label">
        <input type="checkbox" id="tosCheck1" />
        <span>이용약관에 동의합니다 (필수)</span>
      </label>
      <label class="checkbox-label" style="margin-top:8px">
        <input type="checkbox" id="tosCheck2" />
        <span>발명 내용에 대한 기밀유지에 동의합니다 (필수)</span>
      </label>
      <button class="btn btn-primary btn-full" style="margin-top:20px" onclick="handleTosAccept()">
        동의하고 계속하기
      </button>
    </div>
  </div>
</div>

<!-- ═══════════════ Pending Screen ═══════════════ -->
<div id="screenPending" class="screen">
  <div class="auth-wrapper">
    <div class="auth-logo">
      <img src="logo.png" alt="DIDIM IP" class="logo-img" />
    </div>
    <div class="card" style="max-width:480px;margin:0 auto;text-align:center">
      <div style="font-size:48px;margin-bottom:16px"><span class="tossface">⏳</span></div>
      <h2 style="margin-bottom:8px">승인 대기 중이에요</h2>
      <p class="card-description">관리자가 계정을 확인하고 있어요. 승인 후 이용 가능합니다.</p>
      <button class="btn btn-secondary" style="margin-top:20px" onclick="checkApprovalStatus()">
        상태 확인
      </button>
      <button class="btn btn-ghost" style="margin-top:8px" onclick="handleLogout()">
        로그아웃
      </button>
    </div>
  </div>
</div>

<!-- ═══════════════ Project Dashboard ═══════════════ -->
<div id="screenDashboard" class="screen">
  <div class="app-container">
    <header class="app-header">
      <div class="header-left">
        <img src="logo.png" alt="DIDIM IP" class="header-logo" />
        <span class="header-title">사건 관리</span>
      </div>
      <div class="header-right">
        <span id="dashUserName" class="header-user"></span>
        <button id="btnDashAdmin" class="btn btn-ghost btn-sm" style="display:none" onclick="showScreen('admin')">
          <span class="tossface">⚙️</span> 관리
        </button>
        <button class="btn btn-ghost btn-sm" onclick="handleLogout()">로그아웃</button>
      </div>
    </header>

    <!-- 새 사건 만들기 -->
    <div class="card" style="text-align:center;padding:32px;margin-bottom:16px;cursor:pointer;border:2px dashed var(--color-border)" onclick="openNewProjectModal()">
      <div style="font-size:48px;margin-bottom:12px"><span class="tossface">➕</span></div>
      <div style="font-size:18px;font-weight:600;color:var(--color-primary)">새 사건 만들기</div>
      <div style="font-size:13px;color:var(--color-text-tertiary);margin-top:4px">새로운 특허명세서 작성을 시작합니다</div>
    </div>

    <!-- 기존 사건 목록 -->
    <div class="card">
      <div class="card-header">
        <div class="card-title"><span class="tossface">📂</span> 내 사건 목록</div>
        <div class="card-description" id="dashProjectCount">0건</div>
      </div>
      <div id="dashProjectList" style="padding:0 16px 16px"></div>
    </div>
  </div>
</div>

<!-- New Project Modal -->
<div id="newProjectModal" class="modal-overlay" style="display:none">
  <div class="modal-content">
    <div class="modal-title"><span class="tossface">📝</span> 새 사건 만들기</div>
    <div class="modal-body">사건명을 입력해 주세요.</div>
    <input type="text" class="input-field" id="newProjectTitle" placeholder="예: 공기 청결도 기반 가습기 분무량 제어 서버" />
    <div style="display:flex;gap:8px;margin-top:16px">
      <button class="btn btn-ghost" onclick="closeNewProjectModal()" style="flex:1">취소</button>
      <button class="btn btn-primary" onclick="createAndOpenProject()" style="flex:1">만들기</button>
    </div>
  </div>
</div>

<!-- ═══════════════ API Key Modal ═══════════════ -->
<div id="apiKeyModal" class="modal-overlay" style="display:none">
  <div class="modal-content">
    <div class="modal-title"><span class="tossface">🔑</span> API Key 입력</div>
    <div class="modal-body">
      특허명세서 생성에 사용할 Anthropic API Key를 입력해 주세요.
    </div>
    <input type="password" class="input-field" id="apiKeyInput" placeholder="sk-ant-api03-..." />
    <p class="input-hint">
      발급: <a href="https://console.anthropic.com/settings/keys" target="_blank">console.anthropic.com</a>
    </p>
    <button class="btn btn-primary btn-full" onclick="saveApiKey()" style="margin-top:16px">
      시작하기
    </button>
  </div>
</div>

<!-- ═══════════════ Admin Panel (conditionally shown) ═══════════════ -->
<div id="adminPanel" class="screen" style="display:none">
  <div class="app-container">
    <header class="app-header">
      <div class="header-left">
        <img src="logo.png" alt="DIDIM IP" class="header-logo" />
        <span class="badge badge-error">관리자</span>
      </div>
      <button class="btn btn-ghost btn-sm" onclick="showScreen('dashboard')">사건 목록으로</button>
    </header>
    <div class="card">
      <div class="card-header">
        <div class="card-title"><span class="tossface">👥</span> 사용자 관리</div>
      </div>
      <div id="adminUserList"></div>
    </div>
  </div>
</div>

<!-- ═══════════════ Main App ═══════════════ -->
<div id="screenMain" class="screen" style="display:none">
  <div class="app-container">

    <!-- Header -->
    <header class="app-header">
      <div class="header-left">
        <button class="btn btn-ghost btn-sm" onclick="backToDashboard()" title="사건 목록으로">
          <span class="tossface">←</span>
        </button>
        <img src="logo.png" alt="DIDIM IP" class="header-logo" />
        <span id="headerProjectName" class="header-title" style="max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap">특허명세서</span>
      </div>
      <div class="header-right">
        <button class="btn btn-secondary btn-sm" onclick="saveProject()">
          <span class="tossface">💾</span> 저장
        </button>
        <span id="headerUserName" class="header-user"></span>
        <button id="btnAdmin" class="btn btn-ghost btn-sm" style="display:none" onclick="showScreen('admin')">
          <span class="tossface">⚙️</span> 관리
        </button>
        <button class="btn btn-ghost btn-sm" onclick="handleLogout()">로그아웃</button>
      </div>
    </header>

    <!-- Tab Navigation -->
    <div class="tab-container" role="tablist">
      <button class="tab-item active" role="tab" aria-selected="true" onclick="switchTab(0)">
        <span class="tab-icon tossface">📋</span>
        <span class="tab-label">기본정보</span>
      </button>
      <button class="tab-item" role="tab" aria-selected="false" onclick="switchTab(1)">
        <span class="tab-icon tossface">⚖️</span>
        <span class="tab-label">청구범위</span>
      </button>
      <button class="tab-item" role="tab" aria-selected="false" onclick="switchTab(2)">
        <span class="tab-icon tossface">🖼️</span>
        <span class="tab-label">도면·설명</span>
      </button>
      <button class="tab-item" role="tab" aria-selected="false" onclick="switchTab(3)">
        <span class="tab-icon tossface">🔍</span>
        <span class="tab-label">검토</span>
      </button>
      <button class="tab-item" role="tab" aria-selected="false" onclick="switchTab(4)">
        <span class="tab-icon tossface">📥</span>
        <span class="tab-label">산출물</span>
      </button>
    </div>

    <!-- ── TAB 0: 기본정보 ── -->
    <div id="page0" class="page active" role="tabpanel">

      <!-- Invention Content -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">📁</span> 발명 내용</div>
        </div>
        <textarea class="textarea-field" id="projectInput" rows="6"
          placeholder="발명의 핵심 기술, 구성요소, 차별점 등을 상세히 입력해 주세요..."></textarea>
        <div class="card-description">입력이 상세할수록 더 정확한 명세서가 생성돼요.</div>
      </div>

      <!-- Step 1: Title -->
      <div class="card" id="cardStep01">
        <div class="card-header">
          <div class="card-title"><span class="tossface">🏷️</span> Step 1: 발명의 명칭</div>
        </div>
        <p class="card-description" style="margin-bottom:12px">발명의 유형을 선택하고, 명칭 후보를 생성하세요.</p>

        <!-- Title Type Selection -->
        <div class="selection-cards" id="titleTypeCards">
          <div class="selection-card" onclick="selectTitleType(this,'서버')">
            <div class="selection-card-category">A</div>
            <div class="selection-card-title">~서버</div>
          </div>
          <div class="selection-card" onclick="selectTitleType(this,'방법')">
            <div class="selection-card-category">B</div>
            <div class="selection-card-title">~방법</div>
          </div>
          <div class="selection-card" onclick="selectTitleType(this,'시스템')">
            <div class="selection-card-category">C</div>
            <div class="selection-card-title">~시스템</div>
          </div>
          <div class="selection-card" onclick="selectTitleType(this,'서버 및 방법')">
            <div class="selection-card-category">D</div>
            <div class="selection-card-title">~서버 및 방법</div>
          </div>
        </div>

        <button class="btn btn-primary btn-full" id="btnStep01" onclick="runStep('step_01')" disabled>
          <span class="tossface">🤖</span> 명칭 후보 생성 (5개)
        </button>
        <div id="resultStep01"></div>

        <!-- Confirmed title -->
        <div id="titleConfirmArea" style="display:none;margin-top:12px">
          <label style="font-size:13px;font-weight:600;color:var(--color-text-secondary)">확정 명칭</label>
          <input type="text" class="input-field input-highlight" id="titleInput" oninput="onTitleInput()" style="margin-top:4px" />
          <div id="titleConfirmMsg" class="confirm-msg" style="display:none">
            <span class="tossface">✅</span> 명칭이 확정되었어요
          </div>
        </div>
      </div>

      <!-- Step 2~5: Batch -->
      <div id="batchArea" style="display:none">
        <div class="card">
          <div class="card-header">
            <div class="card-title"><span class="tossface">🚀</span> Step 2~5: 기본 항목 일괄 생성</div>
          </div>
          <div class="step-desc-list">
            <div class="step-desc-item"><strong>Step 2 — 기술분야:</strong> 발명이 속하는 기술 분야를 한 문장으로 정의합니다.</div>
            <div class="step-desc-item"><strong>Step 3 — 배경기술:</strong> 발명의 배경이 되는 기존 기술과 문제점을 서술합니다.</div>
            <div class="step-desc-item"><strong>Step 4 — 선행기술문헌:</strong> 관련 선행기술문헌을 기재합니다.</div>
            <div class="step-desc-item"><strong>Step 5 — 해결과제:</strong> 본 발명이 해결하고자 하는 기술적 과제를 명시합니다.</div>
          </div>
          <div id="progressBatch" style="margin:12px 0"></div>
          <button class="btn btn-primary btn-full" id="btnBatch25" onclick="runBatch25()">
            <span class="tossface">🚀</span> 일괄 생성
          </button>
          <div id="resultsBatch25"></div>
        </div>
      </div>
    </div>

    <!-- ── TAB 1: 청구범위 ── -->
    <div id="page1" class="page" role="tabpanel">

      <!-- Method Toggle -->
      <div class="card" style="padding:16px 20px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <span style="font-weight:600;font-size:15px"><span class="tossface">⚡</span> 방법 청구항 포함</span>
          <label class="toggle-switch">
            <input type="checkbox" id="methodToggle" checked onchange="toggleMethod()" />
            <span class="toggle-slider"></span>
          </label>
        </div>
      </div>

      <!-- Step 6: Device Claims -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">⚖️</span> Step 6: 장치 청구항</div>
        </div>
        <div class="option-row">
          <label>독립항</label>
          <input type="number" class="input-field input-sm" id="optDeviceIndep" value="1" min="0" max="10" />
          <label>종속항</label>
          <input type="number" class="input-field input-sm" id="optDeviceDep" value="9" min="0" max="20" />
        </div>
        <p class="card-description" style="margin-top:8px;font-size:12px;color:var(--color-text-tertiary)">
          <span class="tossface">🛡️</span> 생성 후 기재불비(상기 선행기재, 제한적 표현, 참조 무결성)를 자동 검증하고 수정된 최종본을 출력합니다.
        </p>
        <button class="btn btn-primary btn-full" id="btnStep06" onclick="runStep('step_06')" style="margin-top:8px">
          <span class="tossface">🤖</span> 장치 청구항 생성
        </button>
        <div id="progressStep06" style="margin-top:8px"></div>
        <div id="resultStep06"></div>
      </div>

      <!-- Step 10: Method Claims (conditional) -->
      <div id="methodClaimsCard" class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">⚖️</span> Step 10: 방법 청구항</div>
        </div>
        <div class="option-row">
          <label>독립항</label>
          <input type="number" class="input-field input-sm" id="optMethodIndep" value="1" min="0" max="10" />
          <label>종속항</label>
          <input type="number" class="input-field input-sm" id="optMethodDep" value="9" min="0" max="20" />
        </div>
        <button class="btn btn-primary btn-full" id="btnStep10" onclick="runStep('step_10')" style="margin-top:12px">
          <span class="tossface">🤖</span> 방법 청구항 생성
        </button>
        <div id="resultStep10"></div>
      </div>

      <!-- Step 14, 15 -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">🔧</span> 추가 검토</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="btn btn-outline" style="flex:1" onclick="runStep('step_14')">
            대안 청구항
          </button>
          <button class="btn btn-outline" style="flex:1" onclick="runStep('step_15')">
            기재불비 검토
          </button>
        </div>
        <div id="resultStep14"></div>
        <div id="resultStep15"></div>
      </div>
    </div>

    <!-- ── TAB 2: 도면 & 설명 ── -->
    <div id="page2" class="page" role="tabpanel">

      <!-- Step 7: Diagrams -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">🖼️</span> Step 7: 장치 도면 설계</div>
        </div>
        <div class="option-row">
          <label>도면 수</label>
          <input type="number" class="input-field input-sm" id="optDeviceFigures" value="4" min="1" max="10" />
        </div>
        <button class="btn btn-primary btn-full" id="btnStep07" onclick="runDiagramStep('step_07')" style="margin-top:12px">
          <span class="tossface">🤖</span> 도면 설계 생성
        </button>
        <div id="resultStep07"></div>
        <div id="diagramsStep07" class="diagrams-area"></div>
        <button class="btn btn-outline btn-full" id="btnPptx07" onclick="downloadPptx('step_07')" style="display:none;margin-top:8px">
          <span class="tossface">📊</span> PPTX 다운로드
        </button>
      </div>

      <!-- Step 8: Device Detailed Description -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">📝</span> Step 8: 장치 상세설명</div>
        </div>
        <div id="progressStep08" style="margin-bottom:8px"></div>
        <button class="btn btn-primary btn-full" id="btnStep08" onclick="runLongStep('step_08')">
          <span class="tossface">🤖</span> 상세설명 생성 (자동이어쓰기)
        </button>
        <div id="resultStep08"></div>
      </div>

      <!-- Step 9: Math Formulas -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">🔢</span> Step 9: 수학식 삽입</div>
        </div>
        <p class="card-description">상세설명에 핵심 알고리즘 수학식을 삽입해요. 기존 내용은 유지됩니다.</p>
        <button class="btn btn-primary btn-full" id="btnStep09" onclick="runMathInsertion()" style="margin-top:12px">
          <span class="tossface">🔢</span> 수학식 생성 및 삽입
        </button>
        <div id="resultStep09"></div>
      </div>

      <!-- Step 11: Method Diagrams (conditional) -->
      <div id="methodDiagramCard" class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">📊</span> Step 11: 방법 도면</div>
        </div>
        <div class="option-row">
          <label>흐름도 수</label>
          <input type="number" class="input-field input-sm" id="optMethodFigures" value="2" min="1" max="5" />
        </div>
        <button class="btn btn-primary btn-full" id="btnStep11" onclick="runDiagramStep('step_11')" style="margin-top:12px">
          <span class="tossface">🤖</span> 방법 도면 생성
        </button>
        <div id="resultStep11"></div>
        <div id="diagramsStep11" class="diagrams-area"></div>
      </div>

      <!-- Step 12: Method Description (conditional) -->
      <div id="methodDescCard" class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">📝</span> Step 12: 방법 상세설명</div>
        </div>
        <div id="progressStep12" style="margin-bottom:8px"></div>
        <button class="btn btn-primary btn-full" id="btnStep12" onclick="runLongStep('step_12')">
          <span class="tossface">🤖</span> 방법 상세설명 생성
        </button>
        <div id="resultStep12"></div>
      </div>
    </div>

    <!-- ── TAB 3: 검토 ── -->
    <div id="page3" class="page" role="tabpanel">

      <!-- Step 13: Review -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">🔍</span> Step 13: AI 검토</div>
        </div>
        <p class="card-description" style="margin-bottom:12px">청구항 뒷받침, 기술적 비약, 수학식 정합성, 반복 실시 가능성을 검토합니다.</p>
        <button class="btn btn-primary btn-full" id="btnStep13" onclick="runStep('step_13')">
          <span class="tossface">🔍</span> AI 검토 실행
        </button>
        <div id="resultStep13"></div>
        <button class="btn btn-primary btn-full" id="btnApplyReview" onclick="applyReview()" style="display:none;margin-top:8px">
          <span class="tossface">🔄</span> 검토 반영 → Step 8 보완 → Step 9 수학식 삽입 (순차 실행)
        </button>
        <div id="progressApplyReview" style="margin-top:8px"></div>
        <div id="reviewApplyResult" style="display:none;margin-top:12px">
          <div class="card" style="border:2px solid var(--color-primary);background:var(--color-bg-secondary)">
            <div class="card-header"><div class="card-title"><span class="tossface">✅</span> 반영 결과</div></div>
            <p class="card-description" style="margin-bottom:8px">검토 내용이 아래 순서로 반영되었습니다:<br>
              ① <strong>Step 8 상세설명</strong> — 검토 지적사항 보완 (도면당 ~2,000자)<br>
              ② <strong>Step 9 수학식</strong> — 보완된 상세설명에 수학식 재삽입<br>
              아래에서 반영 전/후를 비교할 수 있습니다.</p>
            <div style="display:flex;gap:8px;margin-bottom:8px">
              <button class="btn btn-outline btn-sm" onclick="showReviewDiff('before')" id="btnDiffBefore">반영 전</button>
              <button class="btn btn-primary btn-sm" onclick="showReviewDiff('after')" id="btnDiffAfter">반영 후 (현재)</button>
            </div>
            <textarea class="result-textarea" id="reviewDiffArea" rows="12" readonly></textarea>
          </div>
        </div>
      </div>

      <!-- Step 16~19: Batch Finish -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">🚀</span> Step 16~19: 마무리 일괄 생성</div>
        </div>
        <div class="step-desc-list">
          <div class="step-desc-item"><strong>Step 16 — 발명의 효과:</strong> 발명의 효과를 50단어 이내로 작성합니다.</div>
          <div class="step-desc-item"><strong>Step 17 — 과제의 해결 수단:</strong> 과제를 해결하는 기술적 수단을 기술합니다.</div>
          <div class="step-desc-item"><strong>Step 18 — 도면 부호:</strong> 도면의 주요 부분 부호를 정리합니다.</div>
          <div class="step-desc-item"><strong>Step 19 — 요약서:</strong> 청구항 1 기반 150단어 요약서를 작성합니다.</div>
        </div>
        <div id="progressBatchFinish" style="margin:12px 0"></div>
        <button class="btn btn-primary btn-full" id="btnBatchFinish" onclick="runBatchFinish()">
          <span class="tossface">🚀</span> 마무리 일괄 생성
        </button>
        <div id="resultsBatchFinish"></div>
      </div>

      <!-- Auto Validation -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">🛡️</span> 청구항 기재불비 자동 검증</div>
        </div>
        <p class="card-description" style="margin-bottom:12px">
          아래 항목을 자동으로 검증합니다:<br>
          ① <strong>"상기" 선행기재 확인</strong> — 종속항의 "상기 OOO"가 참조 독립항에 기재되어 있는지<br>
          ② <strong>제한적 표현 검출</strong> — "반드시", "~에 한하여" 등 권리범위를 축소시키는 표현<br>
          ③ <strong>청구항 참조 무결성</strong> — 종속항이 존재하는 독립항을 참조하는지
        </p>
        <button class="btn btn-outline btn-full" onclick="runValidation()">
          <span class="tossface">🛡️</span> 검증 실행
        </button>
        <div id="validationResults" style="margin-top:12px"></div>
      </div>
    </div>

    <!-- ── TAB 4: 산출물 ── -->
    <div id="page4" class="page" role="tabpanel">

      <!-- Download Buttons -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">📥</span> 다운로드</div>
        </div>
        <div class="download-btns">
          <button class="btn btn-primary btn-full" onclick="downloadAsWord()">
            <span class="tossface">📄</span> Word (.doc)
          </button>
          <button class="btn btn-outline btn-full" onclick="downloadPptxAll()">
            <span class="tossface">📊</span> PPTX (도면)
          </button>
          <button class="btn btn-outline btn-full" onclick="copyToClipboard()">
            <span class="tossface">📋</span> 전체 복사
          </button>
          <button class="btn btn-outline btn-full" onclick="downloadAsTxt()">
            <span class="tossface">💾</span> TXT
          </button>
        </div>
      </div>

      <!-- Preview -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">👁️</span> 미리보기</div>
        </div>
        <div id="previewArea"></div>
      </div>

      <!-- Stats -->
      <div class="card">
        <div class="card-header">
          <div class="card-title"><span class="tossface">💰</span> 사용량</div>
        </div>
        <div class="stat-row">
          <div class="stat-card stat-card-steps">
            <div class="stat-card-value" id="statCompleted">0/19</div>
            <div class="stat-card-label">완료 Step</div>
          </div>
          <div class="stat-card stat-card-api">
            <div class="stat-card-value" id="statApiCalls">0</div>
            <div class="stat-card-label">API 호출</div>
          </div>
          <div class="stat-card stat-card-cost">
            <div class="stat-card-value" id="statCost">$0.00</div>
            <div class="stat-card-label">예상 비용</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="app-footer">
      특허그룹 디딤 · 시너지앤(주) | 2026
    </footer>
  </div>
</div>

<!-- ═══════════════ Scripts ═══════════════ -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3/dist/pptxgen.bundle.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.5.0/docx.min.js"></script>
<script src="script.js"></script>
</body>
</html>
